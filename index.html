<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">






  <link rel="canonical" href="http://yoursite.com/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Hexo</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Accueil</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/04/函数式解爱因斯坦思考题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tt67wq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/04/函数式解爱因斯坦思考题/" itemprop="url">
                  函数式解爱因斯坦思考题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              

              
                
              

              <time title="Post created: 2018-06-04 13:55:04 / Updated at: 14:13:43" itemprop="dateCreated datePublished" datetime="2018-06-04T13:55:04+08:00">2018-06-04</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近看书《算法的乐趣》中讲了一题很有意思的题目，之前看过之后没有实践，昨天技痒，想写个函数式版本的推理过程，在想象中，我都知道了推理过程了，再去描述出来，应该没太大问题，而编码的过程无情的打了我的脸，磕磕巴巴的编了一上午才跑出结果。看来我果然不是那2%的人。</p>
<p>题目原文</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">据说有五个不同颜色的房间排成一排，每个房间里分别住着一个不同国籍的人，</div><div class="line">每个人都喝一种特定品牌的饮料，抽一种特定品牌的烟，养一种宠物，</div><div class="line">没有任意两个人抽相同品牌的香烟，或喝相同品牌的饮料，或养相同的宠物，</div><div class="line">问题是谁在养鱼作为宠物？</div><div class="line"></div><div class="line">为了寻找答案，爱因斯坦给出了十五条线索:</div><div class="line"></div><div class="line">(1)、英国人住在红色的房子里；</div><div class="line"></div><div class="line">(2)、瑞典人养狗作为宠物；</div><div class="line"></div><div class="line">(3)、丹麦人喝茶；</div><div class="line"></div><div class="line">(4)、绿房子紧挨着白房子，在白房子的左边；</div><div class="line"></div><div class="line">(5)、绿房子的主人喝咖啡；</div><div class="line"></div><div class="line">(6)、抽Pall Mall牌香烟的人养鸟；</div><div class="line"></div><div class="line">(7)、黄色房子里的人抽Dunhill牌香烟；</div><div class="line"></div><div class="line">(8)、住在中间那个房子里的人喝牛奶；</div><div class="line"></div><div class="line">(9)、挪威人住在第一个房子里面；</div><div class="line"></div><div class="line">(10)、抽Blends牌香烟的人和养猫的人相邻；</div><div class="line"></div><div class="line">(11)、养马的人和抽Dunhill牌香烟的人相邻；</div><div class="line"></div><div class="line">(12)、抽BlueMaster牌香烟的人和啤酒；</div><div class="line"></div><div class="line">(13)、德国人抽Prince牌香烟；</div><div class="line"></div><div class="line">(14)、挪威人和住在蓝房子的人相邻；</div><div class="line"></div><div class="line">(15)、抽Blends牌香烟的人和喝矿泉水的人相邻。</div></pre></td></tr></table></figure>
<p>根据条件的性质，可以把线索进行分类</p>
<ul>
<li><p>单个属性类</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">(1)、英国人住在红色的房子里；  </div><div class="line">(2)、瑞典人养狗作为宠物；</div><div class="line">(3)、丹麦人喝茶；</div><div class="line">(5)、绿房子的主人喝咖啡；</div><div class="line">(6)、抽Pall Mall牌香烟的人养鸟；</div><div class="line">(7)、黄色房子里的人抽Dunhill牌香烟；</div><div class="line">(12)、抽BlueMaster牌香烟的人喝啤酒；</div><div class="line">(13)、德国人抽Prince牌香烟；</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>相邻关系类</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(10)、抽Blends牌香烟的人和养猫的人相邻；</div><div class="line">(11)、养马的人和抽Dunhill牌香烟的人相邻;</div><div class="line">(14)、挪威人和住在蓝房子的人相邻；</div><div class="line">(15)、抽Blends牌香烟的人和喝矿泉水的人相邻。</div></pre></td></tr></table></figure>
</li>
<li><p>其他类</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(8)、住在中间那个房子里的人喝牛奶；	</div><div class="line">(9)、挪威人住在第一个房子里面；</div><div class="line">(4)、绿房子紧挨着白房子，在白房子的左边；</div></pre></td></tr></table></figure>
</li>
</ul>
<p>我们用以下结构表示单个属性和相邻关系，至于其他类，在代码中具体讨论</p>
<ul>
<li><p>单个属性</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">defmodule EinsteinProblem.Bind do</div><div class="line"> 		defstruct first_type: nil,</div><div class="line">           		first_value: nil,</div><div class="line">           		second_type: nil,</div><div class="line">           		second_value: nil</div><div class="line">end</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>相邻属性</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">defmodule EinsteinProblem.Relation do</div><div class="line">  defstruct item_type: nil,</div><div class="line">            item_value: nil,</div><div class="line">            related_type: nil,</div><div class="line">            related_value: nil</div><div class="line">end</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="具体思路"><a href="#具体思路" class="headerlink" title="具体思路"></a>具体思路</h3><p>首先我们枚举出所有符合条件的单个属性集合体</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">items =</div><div class="line">  for color &lt;- [&quot;red&quot;, &quot;yellow&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;white&quot;],</div><div class="line">      nation &lt;- [&quot;England&quot;, &quot;Sweden&quot;, &quot;Denmark&quot;, &quot;Germany&quot;, &quot;Norway&quot;],</div><div class="line">      drink &lt;- [&quot;water&quot;, &quot;tea&quot;, &quot;milk&quot;, &quot;coffee&quot;, &quot;beer&quot;],</div><div class="line">      pet &lt;- [&quot;cat&quot;, &quot;horse&quot;, &quot;fish&quot;, &quot;bird&quot;, &quot;dog&quot;],</div><div class="line">      cigaret &lt;- [&quot;dunhill&quot;, &quot;blends&quot;, &quot;pall mall&quot;, &quot;prince&quot;, &quot;bluemater&quot;] do</div><div class="line">    %&#123;</div><div class="line">      &quot;color&quot; =&gt; color,</div><div class="line">      &quot;nation&quot; =&gt; nation,</div><div class="line">      &quot;drink&quot; =&gt; drink,</div><div class="line">      &quot;pet&quot; =&gt; pet,</div><div class="line">      &quot;cigaret&quot; =&gt; cigaret</div><div class="line">    &#125;</div><div class="line">  end</div></pre></td></tr></table></figure>
<p>这里我们用一个map当做五个属性的集合体</p>
<p>接下来自然而然的根据bind和relation的关系进行过滤，这里有个隐藏的bind关系，相邻关系可以反向作为bind的过滤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">def filter_by_binds(item) do</div><div class="line">  l =</div><div class="line">    @binds</div><div class="line">    |&gt; Enum.filter(fn x -&gt; filter_by_bind(item, x) end)</div><div class="line">    |&gt; length()</div><div class="line"></div><div class="line">  l == 8</div><div class="line">end</div><div class="line"></div><div class="line">defp filter_by_bind(item, bind) do</div><div class="line">  cond do</div><div class="line">    Map.fetch!(item, bind.first_type) == bind.first_value and</div><div class="line">        Map.fetch!(item, bind.second_type) != bind.second_value -&gt;</div><div class="line">      false</div><div class="line"></div><div class="line">    Map.fetch!(item, bind.second_type) == bind.second_value and</div><div class="line">        Map.fetch!(item, bind.first_type) != bind.first_value -&gt;</div><div class="line">      false</div><div class="line"></div><div class="line">    :else -&gt;</div><div class="line">      true</div><div class="line">  end</div><div class="line">end</div><div class="line"></div><div class="line">def filter_by_relations2(item) do</div><div class="line">  l =</div><div class="line">    @relation</div><div class="line">    |&gt; Enum.filter(fn x -&gt; filter_by_relations2(item, x) end)</div><div class="line">    |&gt; length</div><div class="line"></div><div class="line">  l == 5</div><div class="line">end</div><div class="line"></div><div class="line">defp filter_by_relations2(item, relation) do</div><div class="line">  cond do</div><div class="line">    Map.fetch!(item, relation.item_type) == relation.item_value and</div><div class="line">        Map.fetch!(item, relation.related_type) == relation.related_value -&gt;</div><div class="line">      false</div><div class="line"></div><div class="line">    :else -&gt;</div><div class="line">      true</div><div class="line">  end</div><div class="line">end</div></pre></td></tr></table></figure>
<p>到这一步，我一度找不到突破口了，本想把现在筛选出来的47个item进行排列组合再进行下一步筛选，但是A(47, 5)的计算量太大了，大大拖慢了计算速度，明显不是好的算法。</p>
<p>这里注意到那三个没用的其他类条件，根据条件8和9，我们可以首先筛选出房子1和房子3的候选人，根据这些候选人，我们可以穷举出房子2，4，5的所有可能，再进行relation的筛选，就大大降低了复杂度</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">   horse1_cands = items |&gt; Enum.filter(fn x -&gt; Map.fetch!(x, &quot;nation&quot;) == &quot;Norway&quot; end)</div><div class="line"></div><div class="line">   horse3_cands =</div><div class="line">     items</div><div class="line">     |&gt; Enum.filter(fn x -&gt; Map.fetch!(x, &quot;drink&quot;) == &quot;milk&quot; end)</div><div class="line">     |&gt; Enum.filter(fn x -&gt; Map.fetch!(x, &quot;nation&quot;) != &quot;Norway&quot; end)</div><div class="line"></div><div class="line">   for h1 &lt;- horse1_cands,</div><div class="line">       h3 &lt;- horse3_cands do</div><div class="line">     new_items =</div><div class="line">       filter_by_item(items, h1)</div><div class="line">       |&gt; filter_by_item(h3)</div><div class="line"></div><div class="line">     for h2 &lt;- new_items,</div><div class="line">         h4 &lt;- new_items |&gt; filter_by_item(h2),</div><div class="line">         h5 &lt;- new_items |&gt; filter_by_item(h2) |&gt; filter_by_item(h4) do</div><div class="line">       [h1, h2, h3, h4, h5]</div><div class="line">     end</div><div class="line">   end</div><div class="line">   |&gt; Enum.reduce([], fn x, acc -&gt; x ++ acc end)</div><div class="line">   |&gt; Enum.uniq()</div><div class="line">|&gt; Enum.filter(fn x -&gt; filter_by_relations(x) end)</div></pre></td></tr></table></figure>
<p>到这里算出的结果有3个，再使用最后的条件 绿房子紧挨着白房子，在白房子的左边<br>轻松得出结论</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  %&#123;</div><div class="line">    &quot;cigaret&quot; =&gt; &quot;dunhill&quot;,</div><div class="line">    &quot;color&quot; =&gt; &quot;yellow&quot;,</div><div class="line">    &quot;drink&quot; =&gt; &quot;water&quot;,</div><div class="line">    &quot;nation&quot; =&gt; &quot;Norway&quot;,</div><div class="line">    &quot;pet&quot; =&gt; &quot;cat&quot;</div><div class="line">  &#125;,</div><div class="line">  %&#123;</div><div class="line">    &quot;cigaret&quot; =&gt; &quot;blends&quot;,</div><div class="line">    &quot;color&quot; =&gt; &quot;blue&quot;,</div><div class="line">    &quot;drink&quot; =&gt; &quot;tea&quot;,</div><div class="line">    &quot;nation&quot; =&gt; &quot;Denmark&quot;,</div><div class="line">    &quot;pet&quot; =&gt; &quot;horse&quot;</div><div class="line">  &#125;,</div><div class="line">  %&#123;</div><div class="line">    &quot;cigaret&quot; =&gt; &quot;pall mall&quot;,</div><div class="line">    &quot;color&quot; =&gt; &quot;red&quot;,</div><div class="line">    &quot;drink&quot; =&gt; &quot;milk&quot;,</div><div class="line">    &quot;nation&quot; =&gt; &quot;England&quot;,</div><div class="line">    &quot;pet&quot; =&gt; &quot;bird&quot;</div><div class="line">  &#125;,</div><div class="line">  %&#123;</div><div class="line">    &quot;cigaret&quot; =&gt; &quot;prince&quot;,</div><div class="line">    &quot;color&quot; =&gt; &quot;green&quot;,</div><div class="line">    &quot;drink&quot; =&gt; &quot;coffee&quot;,</div><div class="line">    &quot;nation&quot; =&gt; &quot;Germany&quot;,</div><div class="line">    &quot;pet&quot; =&gt; &quot;fish&quot;</div><div class="line">  &#125;,</div><div class="line">  %&#123;</div><div class="line">    &quot;cigaret&quot; =&gt; &quot;bluemater&quot;,</div><div class="line">    &quot;color&quot; =&gt; &quot;white&quot;,</div><div class="line">    &quot;drink&quot; =&gt; &quot;beer&quot;,</div><div class="line">    &quot;nation&quot; =&gt; &quot;Sweden&quot;,</div><div class="line">    &quot;pet&quot; =&gt; &quot;dog&quot;</div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p>具体代码 <a href="https://github.com/tt67wq/euler_project/tree/master/classical_elixir/einstein_problem" target="_blank" rel="external">链接</a></p>
<hr>
<p><img src="/images/wechat.jpeg" alt="Wechat"></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/26/质数校验/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tt67wq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/26/质数校验/" itemprop="url">
                  质数校验
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              

              
                
              

              <time title="Post created: 2018-05-26 13:45:39 / Updated at: 14:10:39" itemprop="dateCreated datePublished" datetime="2018-05-26T13:45:39+08:00">2018-05-26</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在欧拉计划的练习中，有大量的题目是数论方面的，这就避免不了一个经常需要面对的问题，一个数字是不是质数。</p>
<p>那么如何检测一个数字n是不是一个质数</p>
<h3 id="最简单的方法"><a href="#最简单的方法" class="headerlink" title="最简单的方法"></a>最简单的方法</h3><p>有小学水平的数学就能得到一种校验方法，从2到n的平方根去mod(n)，如果存在一个mod结果为0的，就不算是素数。这也是大部分网上能搜到的质数校验方法，用代码实现非常简单</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">defmodule PrimeCheck do</div><div class="line"></div><div class="line">	def prime?(2), do: true</div><div class="line">	def prime?(n) do</div><div class="line">		l = 2..sqrt(n)</div><div class="line">		  |&gt; Enum.filter(fn x -&gt; rem(n, x) == 0 end)</div><div class="line">		  |&gt; length()</div><div class="line">		l == 0</div><div class="line">	end</div><div class="line">end</div></pre></td></tr></table></figure>
<h3 id="升级一点的方法"><a href="#升级一点的方法" class="headerlink" title="升级一点的方法"></a>升级一点的方法</h3><p>每个数字都能分解成p1^a1*p2^a2…pn^an的形式，所以我们在校验的过程中，没有必要全都校验，只要校验小于n平方根的的素数是否是n的质因数即可，我们只要把已知的素数存下来，就可以用来校验更大的素数。</p>
<p>我们用一个简单的缓存存下我们已经找到的素数</p>
<p>代码实现如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"> require Integer</div><div class="line"> use GenServer</div><div class="line"></div><div class="line"> # 多路缓存</div><div class="line"> ### GenServer API</div><div class="line"> def init(state), do: &#123;:ok, state&#125;</div><div class="line"></div><div class="line"> def handle_call(&#123;:get, tag, key&#125;, _from, state) do</div><div class="line">   case Map.fetch(state, tag) do</div><div class="line">     &#123;:ok, mc&#125; -&gt;</div><div class="line">case Map.fetch(mc, key) do</div><div class="line">  &#123;:ok, value&#125; -&gt; &#123;:reply, value, state&#125;</div><div class="line">  :error -&gt; &#123;:reply, nil, state&#125;</div><div class="line">end</div><div class="line">     :error -&gt; &#123;:reply, nil, state&#125;</div><div class="line">   end</div><div class="line"> end</div><div class="line"></div><div class="line"> def handle_cast(&#123;:set, tag, key, value&#125;, state) do</div><div class="line">   case Map.fetch(state, tag) do</div><div class="line">     &#123;:ok, mc&#125; -&gt;</div><div class="line">&#123;:noreply, Map.update!(state, tag, fn _ -&gt; Map.put(mc, key, value) end)&#125;</div><div class="line">     :error -&gt;</div><div class="line">&#123;:noreply, Map.put(state, tag, %&#123;key =&gt; value&#125;)&#125;</div><div class="line">   end</div><div class="line"> end</div><div class="line"></div><div class="line"> ### Client</div><div class="line"> def start_link(state \\ %&#123;&#125;) do</div><div class="line">   GenServer.start_link(__MODULE__, state, name: __MODULE__)</div><div class="line"> end</div><div class="line"></div><div class="line"> def get(tag, key), do: GenServer.call(__MODULE__, &#123;:get, tag, key&#125;)</div><div class="line"> def set(tag, key, value), do: GenServer.cast(__MODULE__, &#123;:set, tag, key, value&#125;)</div><div class="line"></div><div class="line"></div><div class="line"> @doc &quot;&quot;&quot;</div><div class="line"> 质数检查</div><div class="line"> &quot;&quot;&quot;</div><div class="line"> @spec prime?(Integer) :: boolean</div><div class="line"> def prime?(2), do: true</div><div class="line"> def prime?(3), do: true</div><div class="line"> def prime?(x) do</div><div class="line">   cond do</div><div class="line">     Integer.is_even(x) -&gt; false</div><div class="line">     :else -&gt; is_prime(x, 3)</div><div class="line">   end</div><div class="line"> end</div><div class="line"></div><div class="line"> defp is_prime(x, c) when c * c &gt; x, do: true</div><div class="line"> defp is_prime(x, c) do</div><div class="line">   cond do</div><div class="line">     rem(x, c) == 0 -&gt; false</div><div class="line">     :else -&gt; is_prime(x, next_prime(c))</div><div class="line">   end</div><div class="line"> end</div><div class="line"></div><div class="line"> @doc &quot;&quot;&quot;</div><div class="line"> 找到第N个质数</div><div class="line"> &quot;&quot;&quot;</div><div class="line"> @spec n_prime(Integer) :: Integer</div><div class="line"> def n_prime(1), do: 2</div><div class="line"> def n_prime(n), do: np(n, 1, 2)</div><div class="line"> defp np(n, index, acc) when index == n, do: acc</div><div class="line"> defp np(n, index, acc) when index &lt; n, do: np(n, index+1, next_prime(acc))</div><div class="line"></div><div class="line"> def cache_n_prime(n) do</div><div class="line">   cached_value = get(:n_prime, n)</div><div class="line">   case cached_value do</div><div class="line">     nil -&gt;</div><div class="line">value = n_prime(n)</div><div class="line">set(:n_prime, n, value)</div><div class="line">value</div><div class="line">     _ -&gt; cached_value</div><div class="line">   end</div><div class="line"> end</div><div class="line"></div><div class="line"> @doc &quot;&quot;&quot;</div><div class="line"> 获得下一个质数</div><div class="line"> &quot;&quot;&quot;</div><div class="line"> def next_prime(2), do: 3</div><div class="line"> def next_prime(x) do</div><div class="line">   cond do</div><div class="line">     Integer.is_even(x) -&gt; np(x + 1)</div><div class="line">     :else -&gt; np(x + 2)</div><div class="line">   end</div><div class="line"> end</div><div class="line"> defp np(y) do</div><div class="line">   cond do</div><div class="line">     cache_prime?(y) -&gt; y</div><div class="line">     :else -&gt; np(y + 2)</div><div class="line">   end</div><div class="line"> end</div><div class="line"></div><div class="line"> @doc &quot;&quot;&quot;</div><div class="line"> 缓存的质数判断</div><div class="line"> &quot;&quot;&quot;</div><div class="line"> def cache_prime?(x) do</div><div class="line">   cached_value = get(:prime, x)</div><div class="line">   case cached_value do</div><div class="line">     nil -&gt;</div><div class="line">value = prime?(x)</div><div class="line">set(:prime, x, value)</div><div class="line">value</div><div class="line">     _ -&gt; cached_value</div><div class="line">   end</div><div class="line"> end</div></pre></td></tr></table></figure>
<h3 id="究极形态"><a href="#究极形态" class="headerlink" title="究极形态"></a>究极形态</h3><p>方法二已经能在挺大的范围内高速校验一个素数，但是有个题目需要我再10^16的大小附近做校验，这个方法就不好使了，而且缓存的IO也是这个方法的瓶颈，我查阅的相关资料，发现已经有前人给出了更好的解法，就是 Miller-Rabin素数判定方法。</p>
<p>这个方法的原理是基于费马小定理</p>
<ul>
<li>费马小定理：对于质数p和任意整数a，有ap≡a(mod p)(同余)。反之，若满足ap≡a(mod p)，p也有很大概率为质数。将两边同时约去一个a，则有a(p−1)≡1(mod p)</li>
</ul>
<p>这个方法的原理和可以参考链接<a href="https://blog.csdn.net/alps1992/article/details/51588971" target="_blank" rel="external">Miller-Rabin素数判定方法</a></p>
<p>这篇文章中解释的已经非常好了，但是算法实现还有改进的空间，比如，在算a^u % n的时候，他是硬算的，如果类型设置不恰当，很容易溢出，这里如果用到同余定理就会更好。</p>
<p>还有点需要注意，就是这个方法是个概率判定方法，本质上它是判定一个数是不是合数的方法，判素数就需要我们多做几次检测，把概率提高点</p>
<p>代码实现如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line">defmodule MillerRabin do</div><div class="line">  @moduledoc &quot;&quot;&quot;</div><div class="line">  Miller-Rabin素数判定方法</div><div class="line">  a(p−1)≡1(mod p)</div><div class="line">  如果p是奇素数，则 x2≡1(mod p)的解为x≡1或x≡p−1(mod p)</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  require Integer</div><div class="line">  def prime?(n) when n &lt; 2, do: false</div><div class="line">  def prime?(2), do: true</div><div class="line">  def prime?(n) when Integer.is_even(n), do: false</div><div class="line"></div><div class="line">  def prime?(n), do: fermat_check(n, get_u(n - 1), 3)</div><div class="line"></div><div class="line">  defp fermat_check(_, _, 0), do: true</div><div class="line"></div><div class="line">  defp fermat_check(n, u, s) do</div><div class="line">    a = Enum.random(2..(n - 1))</div><div class="line">    x = pow_mod(a, u, n)</div><div class="line">    &#123;flag, nx&#125; = double_check(u, n, x)</div><div class="line"></div><div class="line">    case flag do</div><div class="line">      true -&gt;</div><div class="line">        case nx do</div><div class="line">          1 -&gt; fermat_check(n, u, s - 1)</div><div class="line">          _ -&gt; false</div><div class="line">        end</div><div class="line"></div><div class="line">      false -&gt;</div><div class="line">        false</div><div class="line">    end</div><div class="line">  end</div><div class="line"></div><div class="line">  defp double_check(tu, n, x) when tu &gt;= n, do: &#123;true, x&#125;</div><div class="line"></div><div class="line">  defp double_check(tu, n, x) do</div><div class="line">    y = Integer.mod(x * x, n)</div><div class="line"></div><div class="line">    cond do</div><div class="line">      y == 1 and x != 1 and x != n - 1 -&gt; &#123;false, 0&#125;</div><div class="line">      :else -&gt; double_check(tu * 2, n, y)</div><div class="line">    end</div><div class="line">  end</div><div class="line"></div><div class="line">  # 同余定理</div><div class="line">  def pow_mod(m, 1, k), do: Integer.mod(m, k)</div><div class="line">  def pow_mod(m, 2, k), do: Integer.mod(m * m, k)</div><div class="line"></div><div class="line">  def pow_mod(m, n, k) do</div><div class="line">    t = Integer.mod(m, k)</div><div class="line"></div><div class="line">    cond do</div><div class="line">      t == 0 -&gt;</div><div class="line">        0</div><div class="line"></div><div class="line">      :else -&gt;</div><div class="line">        cond do</div><div class="line">          Integer.is_even(n) -&gt;</div><div class="line">            pow_mod(m, 2, k) |&gt; pow_mod(div(n, 2), k)</div><div class="line"></div><div class="line">          :else -&gt;</div><div class="line">            ((pow_mod(m, 2, k) |&gt; pow_mod(div(n - 1, 2), k)) * t) |&gt; Integer.mod(k)</div><div class="line">        end</div><div class="line">    end</div><div class="line">  end</div><div class="line"></div><div class="line">  defp get_u(u) do</div><div class="line">    case rem(u, 2) do</div><div class="line">      1 -&gt; get_u(div(u, 2))</div><div class="line">      _ -&gt; u</div><div class="line">    end</div><div class="line">  end</div><div class="line">end</div></pre></td></tr></table></figure>
<p>代码里面我是校验了3次，如果你追求精准度，可以多校验几次</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Erlang/OTP 20 [erts-9.3] [source] [64-bit] [smp:4:4] [ds:4:4:10] [async-threads:10] [hipe] [kernel-poll:false] [dtrace]</div><div class="line"></div><div class="line">Interactive Elixir (1.6.4) - press Ctrl+C to exit (type h() ENTER for help)</div><div class="line">iex(1)&gt; 1..300 |&gt; Enum.filter(fn x -&gt; MillerRabin.prime?(x) end)</div><div class="line">[2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73,</div><div class="line"> 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157,</div><div class="line"> 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, ...]</div></pre></td></tr></table></figure>
<p>非常nice</p>
<p>而且由于是二分检测，成功的把复杂度从之前方法的n2降到了log(n)^k(k是你的校验次数)</p>
<p>有了这个神器之后，素数检测就再也不是问题了！！！</p>
<hr>
<p><img src="/images/wechat.jpeg" alt="Wechat"></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/07/两个有趣的结论/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tt67wq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/07/两个有趣的结论/" itemprop="url">
                  两个有趣的结论
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              

              
                
              

              <time title="Post created: 2018-05-07 12:43:24 / Updated at: 12:48:13" itemprop="dateCreated datePublished" datetime="2018-05-07T12:43:24+08:00">2018-05-07</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近我在处理欧拉题目的过程中得到了两个很有意思的结论，但是目前为止我浅显的数学质数不足以让我证明这些推论</p>
<p>1.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">方程ΣFibonacci(i)x^i = N 有有理数解的冲要条件是</div><div class="line"></div><div class="line">N = Fibonacci(2*n)*Fibonacci(2*n+1)</div></pre></td></tr></table></figure>
<p>2.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">设F(n)=Fibonacci(6*n+3)/2 | n=0,1,2,3...</div><div class="line">任意一对勾股数&#123;a, b, c&#125;, 即 a^2 + b^2 = c^2，a&lt;b&lt;c</div><div class="line">满足 b =  2 * a ± 1 的充要条件是 </div><div class="line">存在自然数n 使得 F(n) = c</div></pre></td></tr></table></figure>
<p><a href="http://oeis.org/" target="_blank" rel="external">oeis</a> 这个网站真是个神器</p>
<hr>
<p><img src="/images/wechat.jpeg" alt="Wechat"></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/20/解决复杂问题的一个思路/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tt67wq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/20/解决复杂问题的一个思路/" itemprop="url">
                  解决复杂问题的一个思路
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              

              
                
              

              <time title="Post created: 2018-04-20 17:59:50" itemprop="dateCreated datePublished" datetime="2018-04-20T17:59:50+08:00">2018-04-20</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Updated at: 2018-04-23 14:08:13" itemprop="dateModified" datetime="2018-04-23T14:08:13+08:00">2018-04-23</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近在练习欧拉计划的过程中，逐渐找到了一个解决较为复杂的穷举问题的指导思想，即为</p>
<blockquote>
<p>化被动验证为主动构造</p>
</blockquote>
<p>看个简单的例子<br><a href="https://projecteuler.net/problem=135" target="_blank" rel="external">欧拉计划135题</a></p>
<p>简单的说就是定义了一个问题</p>
<blockquote>
<p>functioin(n) = Count({x, y, z} |x + z = 2y,  x^2 - y^2 - z^2=n)</p>
</blockquote>
<p>在[1155， 1000000]的范围里面找到function(n)=10的解的个数</p>
<p>老夫首先想到的思路就是先把function(n)这个算法实现了，然后从[1155， 1000000]一路算过去就行了，虽然隐隐的觉得事情没那么简单，但是还是抱着试一试的想法先这么做了。</p>
<p>经过了一通乱算，拼凑了一个效率不怎么好的一个function(n)的实现，等我开始验证的时候发现蛋疼了，性能实在是太差了，验了几分钟才算到2万多，等算到一百万，那估计电脑都要冒烟了。</p>
<p>于是老夫在想，是不是function有啥更巧妙的实现，可以降低复杂度，哪怕降到O(n2)也可以接受，目前的复杂度大概是几何级数级别的。</p>
<p>老夫抓耳挠腮，又是算又是查的折腾了半天，并没有把function实现的更巧妙，反而出现了错误。这让老夫非常沮丧，也开始怀疑这个方向一开始就是不对的。</p>
<p>一怒之下代码全删，开始想新思路，翻看了一些之前的题目，有没有类似这种验证困境的题目，发现了大部分类似的题目都不是通过设计一个巧妙的验证函数来实现，例如找到一百万以内的勾股数类似这样的问题，都是先找到构成解的元素的通项公式，然后通过穷举解的元素来把解的集合找出来。</p>
<p>老夫找出纸和笔，演算了一小会儿，就找到了这个n的通解公式</p>
<blockquote>
<p>n = u * v</p>
<p>u = 4d - x</p>
<p>v = x</p>
</blockquote>
<p>通过穷举符合条件的u和v，老夫终于算出了答案。。。。</p>
<p>以后再遇到类似的验证困境，要考虑一番主动构造的思路。</p>
<p>以上。</p>
<hr>
<p><img src="/images/wechat.jpeg" alt="Wechat"></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/24/稳定匹配问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tt67wq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/24/稳定匹配问题/" itemprop="url">
                  稳定匹配问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              

              
                
              

              <time title="Post created: 2018-02-24 09:03:22" itemprop="dateCreated datePublished" datetime="2018-02-24T09:03:22+08:00">2018-02-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Updated at: 2018-04-23 14:07:50" itemprop="dateModified" datetime="2018-04-23T14:07:50+08:00">2018-04-23</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>《算法的乐趣》第七章有个有意思的问题，叫稳定匹配问题，问题内容是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">有N男N女，每个人都按照他对异性的喜欢程度排名。现在需要写出一个算法安排这N个男的、N个女的结婚，要求两个人的婚姻应该是稳定的。</div><div class="line"></div><div class="line">何为稳定？</div><div class="line"></div><div class="line">有两对夫妻M1 F2，M2 F1。</div><div class="line">M1心目中更喜欢F1，但是他和F2结婚了，M2心目中更喜欢F2，但是命运却让他和F1结婚了，显然这样的婚姻是不稳定的，</div><div class="line">随时都可能发生M1和F1私奔或者M2和F2私奔的情况。</div><div class="line"></div><div class="line">所以在做出匹配选择的时候（也就是结婚的时候），我们需要做出稳定的选择，以防这种情况的发生。</div></pre></td></tr></table></figure>
<p>这题的解法也比较经典</p>
<p>第一轮，每个男人都选择自己名单上排在首位的女人，并向她表白。这种时候会出现两种情况：</p>
<ul>
<li><p>该女士还没有被男生追求过，则该女士接受该男生的请求。</p>
</li>
<li><p>若该女生已经接受过其他男生的追求，那么该女生会将该男士与她的现任男友进行比较，若更喜欢她的男友，那么拒绝这个人的追求，否则，抛弃其男友</p>
</li>
</ul>
<p>第一轮结束后，有些男人已经有女朋友了，有些男人仍然是单身。</p>
<p>在第二轮追女行动中，每个单身男都从所有还没拒绝过他的女孩中选出自己最中意的那一个，并向她表白，不管她现在是否是单身。<br>这种时候还是会遇到上面所说的两种情况，还是同样的解决方案。直到所有人都不在是单身。</p>
<p>这里用elixir简单编写一下这个算法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div></pre></td><td class="code"><pre><div class="line">defmodule StableMatch do</div><div class="line">  require Logger</div><div class="line"></div><div class="line">  @doc &quot;&quot;&quot;</div><div class="line">  生成基本测试数据</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  def generate_base_data() do</div><div class="line">    men_names = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;, &quot;h&quot;]</div><div class="line">    women_names = [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;, &quot;G&quot;, &quot;H&quot;]</div><div class="line">    men_map = %&#123;&#125;</div><div class="line">    women_map = %&#123;&#125;</div><div class="line"></div><div class="line">    men =</div><div class="line">      men_names</div><div class="line">      |&gt; Enum.reduce(men_map, fn x, acc -&gt; Map.put(acc, x, &#123;&quot;&quot;, Enum.shuffle(women_names)&#125;) end)</div><div class="line"></div><div class="line">    women =</div><div class="line">      women_names</div><div class="line">      |&gt; Enum.reduce(women_map, fn x, acc -&gt; Map.put(acc, x, &#123;&quot;&quot;, Enum.shuffle(men_names)&#125;) end)</div><div class="line"></div><div class="line">    &#123;men, women&#125;</div><div class="line">  end</div><div class="line"></div><div class="line">  @doc &quot;&quot;&quot;</div><div class="line">  男人对女人展开追求</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  def choose(women, men, women_name, men_name) do</div><div class="line">    &#123;hus, range&#125; = Map.fetch!(women, women_name)</div><div class="line">    &#123;_, range1&#125; = Map.fetch!(men, men_name)</div><div class="line"></div><div class="line">    case hus do</div><div class="line">      &quot;&quot; -&gt;</div><div class="line">        # 单身的情况</div><div class="line">        women = Map.put(women, women_name, &#123;men_name, range&#125;)</div><div class="line">        men = Map.put(men, men_name, &#123;women_name, range1&#125;)</div><div class="line">        &#123;women, men&#125;</div><div class="line"></div><div class="line">      _ -&gt;</div><div class="line">        &#123;_, range2&#125; = Map.fetch!(men, hus)</div><div class="line"></div><div class="line">        case compare(range, hus, men_name) do</div><div class="line">          :better -&gt;</div><div class="line">            # 如果追求者比现任好，则更换现任</div><div class="line">            women = Map.put(women, women_name, &#123;men_name, range&#125;)</div><div class="line">            men = Map.put(men, men_name, &#123;women_name, range1&#125;)</div><div class="line">            men = Map.put(men, hus, &#123;&quot;&quot;, range2 |&gt; Enum.filter(fn x -&gt; x != women_name end)&#125;)</div><div class="line">            &#123;women, men&#125;</div><div class="line"></div><div class="line">          :worse -&gt;</div><div class="line">            # 不如现任</div><div class="line">            men = Map.put(men, men_name, &#123;&quot;&quot;, range1 |&gt; Enum.filter(fn x -&gt; x != women_name end)&#125;)</div><div class="line"></div><div class="line">            &#123;women, men&#125;</div><div class="line">        end</div><div class="line">    end</div><div class="line">  end</div><div class="line"></div><div class="line">  # 比较两个男人在队列中的位置</div><div class="line">  defp compare([hus | _t], hus, _men_name), do: :worse</div><div class="line">  defp compare([men_name | _t], _, men_name), do: :better</div><div class="line">  defp compare([_ | t], hus, men_name), do: compare(t, hus, men_name)</div><div class="line"></div><div class="line">  @doc &quot;&quot;&quot;</div><div class="line">  所有单身狗对名单上的女人展开追求</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  def iter(women, men) do</div><div class="line">    [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;, &quot;h&quot;]</div><div class="line">    |&gt; Enum.map(fn x -&gt; &#123;x, Map.fetch!(men, x)&#125; end)</div><div class="line">    |&gt; Enum.filter(fn &#123;_, &#123;cp, _&#125;&#125; -&gt; cp == &quot;&quot; end)</div><div class="line">    |&gt; Enum.map(fn &#123;m, &#123;_, [h | _]&#125;&#125; -&gt; &#123;m, h&#125; end)</div><div class="line">    |&gt; Enum.reduce(&#123;women, men&#125;, fn &#123;m, w&#125;, &#123;a, b&#125; -&gt; choose(a, b, w, m) end)</div><div class="line">  end</div><div class="line"></div><div class="line">  def solution() do</div><div class="line">    &#123;men, women&#125; = generate_base_data()</div><div class="line">    Logger.info(&quot;初始数据：&quot;)</div><div class="line">    Logger.info(fn -&gt; inspect(men, pretty: true, limit: 30000) end)</div><div class="line">    Logger.info(fn -&gt; inspect(women, pretty: true, limit: 30000) end)</div><div class="line">    Logger.info(&quot;匹配结果：&quot;)</div><div class="line">    sl(women, men)</div><div class="line">  end</div><div class="line"></div><div class="line">  defp sl(women, men) do</div><div class="line">    &#123;a, b&#125; = iter(women, men)</div><div class="line"></div><div class="line">    cond do</div><div class="line">      a == women and b == men -&gt; &#123;a, b&#125;</div><div class="line">      :else -&gt; sl(a, b)</div><div class="line">    end</div><div class="line">  end</div><div class="line">end</div></pre></td></tr></table></figure>
<p>运行这段代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line">Erlang/OTP 20 [erts-9.2] [source] [64-bit] [smp:4:4] [ds:4:4:10] [async-threads:10] [hipe] [kernel-poll:false] [dtrace]</div><div class="line"></div><div class="line">Interactive Elixir (1.6.1) - press Ctrl+C to exit (type h() ENTER for help)</div><div class="line">iex(1)&gt; StableMatch.solution</div><div class="line"></div><div class="line">09:29:28.455 [info]  初始数据：</div><div class="line"></div><div class="line">09:29:28.466 [info]  %&#123;</div><div class="line">  &quot;A&quot; =&gt; &#123;&quot;&quot;, [&quot;h&quot;, &quot;a&quot;, &quot;f&quot;, &quot;c&quot;, &quot;b&quot;, &quot;g&quot;, &quot;d&quot;, &quot;e&quot;]&#125;,</div><div class="line">  &quot;B&quot; =&gt; &#123;&quot;&quot;, [&quot;f&quot;, &quot;d&quot;, &quot;b&quot;, &quot;g&quot;, &quot;c&quot;, &quot;e&quot;, &quot;h&quot;, &quot;a&quot;]&#125;,</div><div class="line">  &quot;C&quot; =&gt; &#123;&quot;&quot;, [&quot;g&quot;, &quot;b&quot;, &quot;c&quot;, &quot;f&quot;, &quot;d&quot;, &quot;e&quot;, &quot;a&quot;, &quot;h&quot;]&#125;,</div><div class="line">  &quot;D&quot; =&gt; &#123;&quot;&quot;, [&quot;e&quot;, &quot;f&quot;, &quot;d&quot;, &quot;a&quot;, &quot;b&quot;, &quot;h&quot;, &quot;g&quot;, &quot;c&quot;]&#125;,</div><div class="line">  &quot;E&quot; =&gt; &#123;&quot;&quot;, [&quot;e&quot;, &quot;h&quot;, &quot;d&quot;, &quot;b&quot;, &quot;f&quot;, &quot;g&quot;, &quot;a&quot;, &quot;c&quot;]&#125;,</div><div class="line">  &quot;F&quot; =&gt; &#123;&quot;&quot;, [&quot;h&quot;, &quot;g&quot;, &quot;b&quot;, &quot;c&quot;, &quot;f&quot;, &quot;a&quot;, &quot;d&quot;, &quot;e&quot;]&#125;,</div><div class="line">  &quot;G&quot; =&gt; &#123;&quot;&quot;, [&quot;g&quot;, &quot;b&quot;, &quot;d&quot;, &quot;e&quot;, &quot;c&quot;, &quot;a&quot;, &quot;f&quot;, &quot;h&quot;]&#125;,</div><div class="line">  &quot;H&quot; =&gt; &#123;&quot;&quot;, [&quot;h&quot;, &quot;a&quot;, &quot;g&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;c&quot;, &quot;b&quot;]&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">09:29:28.467 [info]  %&#123;</div><div class="line">  &quot;a&quot; =&gt; &#123;&quot;&quot;, [&quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;, &quot;G&quot;, &quot;A&quot;, &quot;H&quot;, &quot;B&quot;]&#125;,</div><div class="line">  &quot;b&quot; =&gt; &#123;&quot;&quot;, [&quot;G&quot;, &quot;C&quot;, &quot;A&quot;, &quot;F&quot;, &quot;H&quot;, &quot;E&quot;, &quot;D&quot;, &quot;B&quot;]&#125;,</div><div class="line">  &quot;c&quot; =&gt; &#123;&quot;&quot;, [&quot;G&quot;, &quot;C&quot;, &quot;D&quot;, &quot;A&quot;, &quot;B&quot;, &quot;E&quot;, &quot;F&quot;, &quot;H&quot;]&#125;,</div><div class="line">  &quot;d&quot; =&gt; &#123;&quot;&quot;, [&quot;D&quot;, &quot;B&quot;, &quot;C&quot;, &quot;G&quot;, &quot;F&quot;, &quot;H&quot;, &quot;A&quot;, &quot;E&quot;]&#125;,</div><div class="line">  &quot;e&quot; =&gt; &#123;&quot;&quot;, [&quot;B&quot;, &quot;H&quot;, &quot;F&quot;, &quot;C&quot;, &quot;G&quot;, &quot;E&quot;, &quot;D&quot;, &quot;A&quot;]&#125;,</div><div class="line">  &quot;f&quot; =&gt; &#123;&quot;&quot;, [&quot;E&quot;, &quot;A&quot;, &quot;B&quot;, &quot;D&quot;, &quot;G&quot;, &quot;C&quot;, &quot;F&quot;, &quot;H&quot;]&#125;,</div><div class="line">  &quot;g&quot; =&gt; &#123;&quot;&quot;, [&quot;D&quot;, &quot;F&quot;, &quot;G&quot;, &quot;C&quot;, &quot;B&quot;, &quot;A&quot;, &quot;E&quot;, &quot;H&quot;]&#125;,</div><div class="line">  &quot;h&quot; =&gt; &#123;&quot;&quot;, [&quot;E&quot;, &quot;G&quot;, &quot;B&quot;, &quot;A&quot;, &quot;F&quot;, &quot;C&quot;, &quot;H&quot;, &quot;D&quot;]&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">09:29:28.467 [info]  匹配结果：</div><div class="line">&#123;%&#123;</div><div class="line">   &quot;A&quot; =&gt; &#123;&quot;a&quot;, [&quot;h&quot;, &quot;a&quot;, &quot;f&quot;, &quot;c&quot;, &quot;b&quot;, &quot;g&quot;, &quot;d&quot;, &quot;e&quot;]&#125;,</div><div class="line">   &quot;B&quot; =&gt; &#123;&quot;f&quot;, [&quot;f&quot;, &quot;d&quot;, &quot;b&quot;, &quot;g&quot;, &quot;c&quot;, &quot;e&quot;, &quot;h&quot;, &quot;a&quot;]&#125;,</div><div class="line">   &quot;C&quot; =&gt; &#123;&quot;c&quot;, [&quot;g&quot;, &quot;b&quot;, &quot;c&quot;, &quot;f&quot;, &quot;d&quot;, &quot;e&quot;, &quot;a&quot;, &quot;h&quot;]&#125;,</div><div class="line">   &quot;D&quot; =&gt; &#123;&quot;d&quot;, [&quot;e&quot;, &quot;f&quot;, &quot;d&quot;, &quot;a&quot;, &quot;b&quot;, &quot;h&quot;, &quot;g&quot;, &quot;c&quot;]&#125;,</div><div class="line">   &quot;E&quot; =&gt; &#123;&quot;h&quot;, [&quot;e&quot;, &quot;h&quot;, &quot;d&quot;, &quot;b&quot;, &quot;f&quot;, &quot;g&quot;, &quot;a&quot;, &quot;c&quot;]&#125;,</div><div class="line">   &quot;F&quot; =&gt; &#123;&quot;g&quot;, [&quot;h&quot;, &quot;g&quot;, &quot;b&quot;, &quot;c&quot;, &quot;f&quot;, &quot;a&quot;, &quot;d&quot;, &quot;e&quot;]&#125;,</div><div class="line">   &quot;G&quot; =&gt; &#123;&quot;b&quot;, [&quot;g&quot;, &quot;b&quot;, &quot;d&quot;, &quot;e&quot;, &quot;c&quot;, &quot;a&quot;, &quot;f&quot;, &quot;h&quot;]&#125;,</div><div class="line">   &quot;H&quot; =&gt; &#123;&quot;e&quot;, [&quot;h&quot;, &quot;a&quot;, &quot;g&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;c&quot;, &quot;b&quot;]&#125;</div><div class="line"> &#125;,</div><div class="line"> %&#123;</div><div class="line">   &quot;a&quot; =&gt; &#123;&quot;A&quot;, [&quot;A&quot;, &quot;H&quot;, &quot;B&quot;]&#125;,</div><div class="line">   &quot;b&quot; =&gt; &#123;&quot;G&quot;, [&quot;G&quot;, &quot;C&quot;, &quot;A&quot;, &quot;F&quot;, &quot;H&quot;, &quot;E&quot;, &quot;D&quot;, &quot;B&quot;]&#125;,</div><div class="line">   &quot;c&quot; =&gt; &#123;&quot;C&quot;, [&quot;C&quot;, &quot;D&quot;, &quot;A&quot;, &quot;B&quot;, &quot;E&quot;, &quot;F&quot;, &quot;H&quot;]&#125;,</div><div class="line">   &quot;d&quot; =&gt; &#123;&quot;D&quot;, [&quot;D&quot;, &quot;B&quot;, &quot;C&quot;, &quot;G&quot;, &quot;F&quot;, &quot;H&quot;, &quot;A&quot;, &quot;E&quot;]&#125;,</div><div class="line">   &quot;e&quot; =&gt; &#123;&quot;H&quot;, [&quot;H&quot;, &quot;F&quot;, &quot;C&quot;, &quot;G&quot;, &quot;E&quot;, &quot;D&quot;, &quot;A&quot;]&#125;,</div><div class="line">   &quot;f&quot; =&gt; &#123;&quot;B&quot;, [&quot;B&quot;, &quot;D&quot;, &quot;G&quot;, &quot;C&quot;, &quot;F&quot;, &quot;H&quot;]&#125;,</div><div class="line">   &quot;g&quot; =&gt; &#123;&quot;F&quot;, [&quot;F&quot;, &quot;G&quot;, &quot;C&quot;, &quot;B&quot;, &quot;A&quot;, &quot;E&quot;, &quot;H&quot;]&#125;,</div><div class="line">   &quot;h&quot; =&gt; &#123;&quot;E&quot;, [&quot;E&quot;, &quot;G&quot;, &quot;B&quot;, &quot;A&quot;, &quot;F&quot;, &quot;C&quot;, &quot;H&quot;, &quot;D&quot;]&#125;</div><div class="line"> &#125;&#125;</div><div class="line">iex(2)&gt; StableMatch.solution</div><div class="line"></div><div class="line">09:29:29.179 [info]  初始数据：</div><div class="line"></div><div class="line">09:29:29.180 [info]  %&#123;</div><div class="line">  &quot;A&quot; =&gt; &#123;&quot;&quot;, [&quot;h&quot;, &quot;g&quot;, &quot;f&quot;, &quot;c&quot;, &quot;e&quot;, &quot;a&quot;, &quot;b&quot;, &quot;d&quot;]&#125;,</div><div class="line">  &quot;B&quot; =&gt; &#123;&quot;&quot;, [&quot;a&quot;, &quot;h&quot;, &quot;e&quot;, &quot;d&quot;, &quot;c&quot;, &quot;f&quot;, &quot;g&quot;, &quot;b&quot;]&#125;,</div><div class="line">  &quot;C&quot; =&gt; &#123;&quot;&quot;, [&quot;h&quot;, &quot;e&quot;, &quot;c&quot;, &quot;b&quot;, &quot;f&quot;, &quot;g&quot;, &quot;d&quot;, &quot;a&quot;]&#125;,</div><div class="line">  &quot;D&quot; =&gt; &#123;&quot;&quot;, [&quot;b&quot;, &quot;g&quot;, &quot;c&quot;, &quot;f&quot;, &quot;h&quot;, &quot;d&quot;, &quot;a&quot;, &quot;e&quot;]&#125;,</div><div class="line">  &quot;E&quot; =&gt; &#123;&quot;&quot;, [&quot;c&quot;, &quot;h&quot;, &quot;d&quot;, &quot;f&quot;, &quot;a&quot;, &quot;e&quot;, &quot;b&quot;, &quot;g&quot;]&#125;,</div><div class="line">  &quot;F&quot; =&gt; &#123;&quot;&quot;, [&quot;c&quot;, &quot;e&quot;, &quot;g&quot;, &quot;a&quot;, &quot;f&quot;, &quot;b&quot;, &quot;d&quot;, &quot;h&quot;]&#125;,</div><div class="line">  &quot;G&quot; =&gt; &#123;&quot;&quot;, [&quot;g&quot;, &quot;c&quot;, &quot;h&quot;, &quot;b&quot;, &quot;d&quot;, &quot;f&quot;, &quot;a&quot;, &quot;e&quot;]&#125;,</div><div class="line">  &quot;H&quot; =&gt; &#123;&quot;&quot;, [&quot;e&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;a&quot;, &quot;g&quot;, &quot;f&quot;, &quot;h&quot;]&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">09:29:29.181 [info]  %&#123;</div><div class="line">  &quot;a&quot; =&gt; &#123;&quot;&quot;, [&quot;G&quot;, &quot;E&quot;, &quot;B&quot;, &quot;A&quot;, &quot;D&quot;, &quot;F&quot;, &quot;C&quot;, &quot;H&quot;]&#125;,</div><div class="line">  &quot;b&quot; =&gt; &#123;&quot;&quot;, [&quot;G&quot;, &quot;B&quot;, &quot;A&quot;, &quot;F&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;H&quot;]&#125;,</div><div class="line">  &quot;c&quot; =&gt; &#123;&quot;&quot;, [&quot;E&quot;, &quot;F&quot;, &quot;H&quot;, &quot;A&quot;, &quot;D&quot;, &quot;G&quot;, &quot;C&quot;, &quot;B&quot;]&#125;,</div><div class="line">  &quot;d&quot; =&gt; &#123;&quot;&quot;, [&quot;C&quot;, &quot;A&quot;, &quot;G&quot;, &quot;D&quot;, &quot;F&quot;, &quot;E&quot;, &quot;B&quot;, &quot;H&quot;]&#125;,</div><div class="line">  &quot;e&quot; =&gt; &#123;&quot;&quot;, [&quot;E&quot;, &quot;F&quot;, &quot;A&quot;, &quot;C&quot;, &quot;H&quot;, &quot;D&quot;, &quot;B&quot;, &quot;G&quot;]&#125;,</div><div class="line">  &quot;f&quot; =&gt; &#123;&quot;&quot;, [&quot;G&quot;, &quot;E&quot;, &quot;A&quot;, &quot;B&quot;, &quot;D&quot;, &quot;C&quot;, &quot;H&quot;, &quot;F&quot;]&#125;,</div><div class="line">  &quot;g&quot; =&gt; &#123;&quot;&quot;, [&quot;F&quot;, &quot;C&quot;, &quot;E&quot;, &quot;G&quot;, &quot;B&quot;, &quot;D&quot;, &quot;H&quot;, &quot;A&quot;]&#125;,</div><div class="line">  &quot;h&quot; =&gt; &#123;&quot;&quot;, [&quot;E&quot;, &quot;H&quot;, &quot;G&quot;, &quot;D&quot;, &quot;C&quot;, &quot;A&quot;, &quot;B&quot;, &quot;F&quot;]&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">09:29:29.181 [info]  匹配结果：</div><div class="line">&#123;%&#123;</div><div class="line">   &quot;A&quot; =&gt; &#123;&quot;f&quot;, [&quot;h&quot;, &quot;g&quot;, &quot;f&quot;, &quot;c&quot;, &quot;e&quot;, &quot;a&quot;, &quot;b&quot;, &quot;d&quot;]&#125;,</div><div class="line">   &quot;B&quot; =&gt; &#123;&quot;a&quot;, [&quot;a&quot;, &quot;h&quot;, &quot;e&quot;, &quot;d&quot;, &quot;c&quot;, &quot;f&quot;, &quot;g&quot;, &quot;b&quot;]&#125;,</div><div class="line">   &quot;C&quot; =&gt; &#123;&quot;g&quot;, [&quot;h&quot;, &quot;e&quot;, &quot;c&quot;, &quot;b&quot;, &quot;f&quot;, &quot;g&quot;, &quot;d&quot;, &quot;a&quot;]&#125;,</div><div class="line">   &quot;D&quot; =&gt; &#123;&quot;d&quot;, [&quot;b&quot;, &quot;g&quot;, &quot;c&quot;, &quot;f&quot;, &quot;h&quot;, &quot;d&quot;, &quot;a&quot;, &quot;e&quot;]&#125;,</div><div class="line">   &quot;E&quot; =&gt; &#123;&quot;c&quot;, [&quot;c&quot;, &quot;h&quot;, &quot;d&quot;, &quot;f&quot;, &quot;a&quot;, &quot;e&quot;, &quot;b&quot;, &quot;g&quot;]&#125;,</div><div class="line">   &quot;F&quot; =&gt; &#123;&quot;e&quot;, [&quot;c&quot;, &quot;e&quot;, &quot;g&quot;, &quot;a&quot;, &quot;f&quot;, &quot;b&quot;, &quot;d&quot;, &quot;h&quot;]&#125;,</div><div class="line">   &quot;G&quot; =&gt; &#123;&quot;b&quot;, [&quot;g&quot;, &quot;c&quot;, &quot;h&quot;, &quot;b&quot;, &quot;d&quot;, &quot;f&quot;, &quot;a&quot;, &quot;e&quot;]&#125;,</div><div class="line">   &quot;H&quot; =&gt; &#123;&quot;h&quot;, [&quot;e&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;a&quot;, &quot;g&quot;, &quot;f&quot;, &quot;h&quot;]&#125;</div><div class="line"> &#125;,</div><div class="line"> %&#123;</div><div class="line">   &quot;a&quot; =&gt; &#123;&quot;B&quot;, [&quot;B&quot;, &quot;A&quot;, &quot;D&quot;, &quot;F&quot;, &quot;C&quot;, &quot;H&quot;]&#125;,</div><div class="line">   &quot;b&quot; =&gt; &#123;&quot;G&quot;, [&quot;G&quot;, &quot;B&quot;, &quot;A&quot;, &quot;F&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;H&quot;]&#125;,</div><div class="line">   &quot;c&quot; =&gt; &#123;&quot;E&quot;, [&quot;E&quot;, &quot;F&quot;, &quot;H&quot;, &quot;A&quot;, &quot;D&quot;, &quot;G&quot;, &quot;C&quot;, &quot;B&quot;]&#125;,</div><div class="line">   &quot;d&quot; =&gt; &#123;&quot;D&quot;, [&quot;D&quot;, &quot;F&quot;, &quot;E&quot;, &quot;B&quot;, &quot;H&quot;]&#125;,</div><div class="line">   &quot;e&quot; =&gt; &#123;&quot;F&quot;, [&quot;F&quot;, &quot;A&quot;, &quot;C&quot;, &quot;H&quot;, &quot;D&quot;, &quot;B&quot;, &quot;G&quot;]&#125;,</div><div class="line">   &quot;f&quot; =&gt; &#123;&quot;A&quot;, [&quot;A&quot;, &quot;B&quot;, &quot;D&quot;, &quot;C&quot;, &quot;H&quot;, &quot;F&quot;]&#125;,</div><div class="line">   &quot;g&quot; =&gt; &#123;&quot;C&quot;, [&quot;C&quot;, &quot;E&quot;, &quot;G&quot;, &quot;B&quot;, &quot;D&quot;, &quot;H&quot;, &quot;A&quot;]&#125;,</div><div class="line">   &quot;h&quot; =&gt; &#123;&quot;H&quot;, [&quot;H&quot;, &quot;G&quot;, &quot;D&quot;, &quot;C&quot;, &quot;A&quot;, &quot;B&quot;, &quot;F&quot;]&#125;</div><div class="line"> &#125;&#125;</div></pre></td></tr></table></figure>
<hr>
<p><img src="/images/wechat.jpeg" alt="Wechat"></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/09/和尚妖怪过河问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tt67wq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/09/和尚妖怪过河问题/" itemprop="url">
                  和尚妖怪过河问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              

              
                
              

              <time title="Post created: 2018-02-09 15:20:33" itemprop="dateCreated datePublished" datetime="2018-02-09T15:20:33+08:00">2018-02-09</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Updated at: 2018-04-23 14:08:06" itemprop="dateModified" datetime="2018-04-23T14:08:06+08:00">2018-04-23</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>《算法的乐趣》第六章有个题目，和尚和妖怪过河。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">有三个和尚和三个妖怪要利用唯一的一条小船过河，</div><div class="line">这条小船一次只能载两个人，同时，无论是在河的两岸还是在船上，</div><div class="line">只要妖怪的数量大于和尚的数量，妖怪们就会将和尚吃掉。</div><div class="line">现在需要选择一种过河的安排，</div><div class="line">保证和尚和妖怪都能过河且和尚不能被妖怪吃掉。</div></pre></td></tr></table></figure>
<p>这是个挺经典的题目，网上的解法一搜一堆，思路也都是差不多，这里用elixir描述一下，感受下ex的简洁</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div></pre></td><td class="code"><pre><div class="line">defmodule MonkAndMonster do</div><div class="line">  @moduledoc &quot;&quot;&quot;</div><div class="line">  有三个和尚和三个妖怪要利用唯一的一条小船过河，这条小船一次只能载两个人，</div><div class="line">  同时，无论是在河的两岸还是在船上，只要妖怪的数量大于和尚的数量，</div><div class="line">  妖怪们就会将和尚吃掉。现在需要选择一种过河的安排，保证和尚和妖怪都能过河且和尚不能被妖怪吃掉。</div><div class="line"></div><div class="line">  定义数据结构</div><div class="line">  初始状态为</div><div class="line">  [&#123;:left, [3, 3]&#125;, &#123;:right, [0, 0]&#125;, &#123;:ship_pos, 0&#125;]</div><div class="line">  简化为 [3,3,0,0,0]</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  @doc &quot;&quot;&quot;</div><div class="line">  状态转换</div><div class="line">  过河的情况无非5种</div><div class="line">  1个和尚过河， 2个和尚过河</div><div class="line">  1个妖怪过河， 2个妖怪过河</div><div class="line">  1个和尚加一个妖怪过河</div><div class="line">  过滤掉非法的状态机和和尚被吃掉的情况</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  def state_iter([lh, lm, rh, rm, 0]) do</div><div class="line">    [</div><div class="line">      [lh - 1, lm, rh + 1, rm, 1],</div><div class="line">      [lh - 2, lm, rh + 2, rm, 1],</div><div class="line">      [lh, lm - 1, rh, rm + 1, 1],</div><div class="line">      [lh, lm - 2, rh, rm + 2, 1],</div><div class="line">      [lh - 1, lm - 1, rh + 1, rm + 1, 1]</div><div class="line">    ]</div><div class="line">    |&gt; Enum.filter(fn x -&gt; not negetive?(x) end)</div><div class="line">    |&gt; Enum.filter(fn x -&gt; safe?(x) end)</div><div class="line">  end</div><div class="line"></div><div class="line">  def state_iter([lh, lm, rh, rm, 1]) do</div><div class="line">    [</div><div class="line">      [lh + 1, lm, rh - 1, rm, 0],</div><div class="line">      [lh + 2, lm, rh - 2, rm, 0],</div><div class="line">      [lh, lm + 1, rh, rm - 1, 0],</div><div class="line">      [lh, lm + 2, rh, rm - 2, 0],</div><div class="line">      [lh + 1, lm + 1, rh - 1, rm - 1, 0]</div><div class="line">    ]</div><div class="line">    |&gt; Enum.filter(fn x -&gt; not negetive?(x) end)</div><div class="line">    |&gt; Enum.filter(fn x -&gt; safe?(x) end)</div><div class="line">  end</div><div class="line"></div><div class="line">  defp negetive?([h | _t]) when h &lt; 0, do: true</div><div class="line">  defp negetive?([_h | t]), do: negetive?(t)</div><div class="line">  defp negetive?([]), do: false</div><div class="line"></div><div class="line">  defp over?([h | _t]), do: h == [0, 0, 3, 3, 1]</div><div class="line"></div><div class="line">  @doc &quot;&quot;&quot;</div><div class="line">  是否全部结束</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  defp all_over?(chains) do</div><div class="line">    l1 = length(chains)</div><div class="line">    l2 = chains |&gt; Enum.filter(fn x -&gt; over?(x) end) |&gt; length()</div><div class="line">    l1 == l2</div><div class="line">  end</div><div class="line"></div><div class="line">  @doc &quot;&quot;&quot;</div><div class="line">  检查是否安全</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  def safe?([lh, lm, 0, _rm, _]), do: lh &gt;= lm</div><div class="line">  def safe?([0, _lm, rh, rm, _]), do: rh &gt;= rm</div><div class="line">  def safe?([lh, lm, rh, rm, _]), do: lh &gt;= lm and rh &gt;= rm</div><div class="line"></div><div class="line">  @doc &quot;&quot;&quot;</div><div class="line">  防止循环</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  def repeat?(chain, state), do: rp(chain, state)</div><div class="line">  defp rp([h | _t], state) when state == h, do: true</div><div class="line">  defp rp([_h | t], state), do: rp(t, state)</div><div class="line">  defp rp([], _state), do: false</div><div class="line"></div><div class="line">  def state_chain([h | t] = chain) do</div><div class="line">    state_iter(h)</div><div class="line">    |&gt; Enum.filter(fn x -&gt; not repeat?(t, x) end)</div><div class="line">    |&gt; Enum.map(fn x -&gt; [x | chain] end)</div><div class="line">  end</div><div class="line"></div><div class="line">  @doc &quot;&quot;&quot;</div><div class="line">  树结构展开为一个列表</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  def state_tree(chains), do: chains |&gt; Enum.reduce([], fn x, acc -&gt; state_chain(x) ++ acc end)</div><div class="line"></div><div class="line">  def solution() do</div><div class="line">    sl([[[3, 3, 0, 0, 0]]])</div><div class="line">  end</div><div class="line"></div><div class="line">  defp sl(chains) do</div><div class="line">    cond do</div><div class="line">      all_over?(chains) -&gt; chains</div><div class="line">      :else -&gt; sl(state_tree(chains))</div><div class="line">    end</div><div class="line">  end</div><div class="line">end</div></pre></td></tr></table></figure>
<p>运行结果为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line">iex(1)&gt; MonkAndMonster.solution</div><div class="line">[</div><div class="line">  [</div><div class="line">    [0, 0, 3, 3, 1],</div><div class="line">    [0, 2, 3, 1, 0],</div><div class="line">    [0, 1, 3, 2, 1],</div><div class="line">    [0, 3, 3, 0, 0],</div><div class="line">    [0, 2, 3, 1, 1],</div><div class="line">    [2, 2, 1, 1, 0],</div><div class="line">    [1, 1, 2, 2, 1],</div><div class="line">    [3, 1, 0, 2, 0],</div><div class="line">    [3, 0, 0, 3, 1],</div><div class="line">    [3, 2, 0, 1, 0],</div><div class="line">    [3, 1, 0, 2, 1],</div><div class="line">    [3, 3, 0, 0, 0]</div><div class="line">  ],</div><div class="line">  [</div><div class="line">    [0, 0, 3, 3, 1],</div><div class="line">    [1, 1, 2, 2, 0],</div><div class="line">    [0, 1, 3, 2, 1],</div><div class="line">    [0, 3, 3, 0, 0],</div><div class="line">    [0, 2, 3, 1, 1],</div><div class="line">    [2, 2, 1, 1, 0],</div><div class="line">    [1, 1, 2, 2, 1],</div><div class="line">    [3, 1, 0, 2, 0],</div><div class="line">    [3, 0, 0, 3, 1],</div><div class="line">    [3, 2, 0, 1, 0],</div><div class="line">    [3, 1, 0, 2, 1],</div><div class="line">    [3, 3, 0, 0, 0]</div><div class="line">  ],</div><div class="line">  [</div><div class="line">    [0, 0, 3, 3, 1],</div><div class="line">    [0, 2, 3, 1, 0],</div><div class="line">    [0, 1, 3, 2, 1],</div><div class="line">    [0, 3, 3, 0, 0],</div><div class="line">    [0, 2, 3, 1, 1],</div><div class="line">    [2, 2, 1, 1, 0],</div><div class="line">    [1, 1, 2, 2, 1],</div><div class="line">    [3, 1, 0, 2, 0],</div><div class="line">    [3, 0, 0, 3, 1],</div><div class="line">    [3, 2, 0, 1, 0],</div><div class="line">    [2, 2, 1, 1, 1],</div><div class="line">    [3, 3, 0, 0, 0]</div><div class="line">  ],</div><div class="line">  [</div><div class="line">    [0, 0, 3, 3, 1],</div><div class="line">    [1, 1, 2, 2, 0],</div><div class="line">    [0, 1, 3, 2, 1],</div><div class="line">    [0, 3, 3, 0, 0],</div><div class="line">    [0, 2, 3, 1, 1],</div><div class="line">    [2, 2, 1, 1, 0],</div><div class="line">    [1, 1, 2, 2, 1],</div><div class="line">    [3, 1, 0, 2, 0],</div><div class="line">    [3, 0, 0, 3, 1],</div><div class="line">    [3, 2, 0, 1, 0],</div><div class="line">    [2, 2, 1, 1, 1],</div><div class="line">    [3, 3, 0, 0, 0]</div><div class="line">  ]</div><div class="line">]</div></pre></td></tr></table></figure>
<p>一共是四种安排方法，与网上解出来的一样</p>
<p>对比下其他语言的解法</p>
<p><a href="http://www.cnblogs.com/zichi/p/5392523.html" target="_blank" rel="external">js</a></p>
<p><a href="http://www.66acg.com/?post=278" target="_blank" rel="external">java</a></p>
<p>自认为ex的代码更加优雅</p>
<hr>
<p><img src="/images/wechat.jpeg" alt="Wechat"></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/07/elixir解倒水问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tt67wq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/07/elixir解倒水问题/" itemprop="url">
                  elixir解倒水问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              

              
                
              

              <time title="Post created: 2018-02-07 11:41:29" itemprop="dateCreated datePublished" datetime="2018-02-07T11:41:29+08:00">2018-02-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Updated at: 2018-04-23 14:07:25" itemprop="dateModified" datetime="2018-04-23T14:07:25+08:00">2018-04-23</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近在读《算法的乐趣》这本书，里面有个问题是如何用3，5，8升的水桶，把8升水平分，是个非常经典的题目，网上搜解法也是一大堆，这里用elixir实现下，通过对比几个语言的实现方法，凸显出elixir语言逻辑清晰的特点。</p>
<p>其实解这个问题挺简单，就是状态转换加搜索，具体就这个思路</p>
<ol>
<li>由当前状态得到所有可能的合法动作</li>
<li>由合法动作得到下一个状态</li>
<li>建立一个状态队列来实现状态记录以及检查新状态是否在队列中已经出现，避免形成死循环</li>
<li>递归搜索，在达到final状态时终止</li>
</ol>
<p>在网上有各种语言的解法，书里面给的C/C++的解法，我是懒得去抄一遍了。</p>
<p>这里有python版本的</p>
<p><a href="https://www.jianshu.com/p/46f6aa196e1e" target="_blank" rel="external">py解法</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line">initial_bucket_state = [0,0,8]</div><div class="line">#水桶的初始状态</div><div class="line">bucket_volume = [3,5,8]</div><div class="line">#每个水桶的对应的容积</div><div class="line">from collections import deque</div><div class="line">record = deque()</div><div class="line">record.append(initial_bucket_state)</div><div class="line">#利用python的deque队列记录状态转移情况，初始化时加入水桶初始状态。deque是可以从头尾插入和删除的队列，在不指定大小时，为一个无边界的队列</div><div class="line"></div><div class="line"></div><div class="line">def nextStateLawful(current_state, bucket_volume):</div><div class="line">    next_action = [</div><div class="line">        (from_, to_) </div><div class="line">        for from_ in range(3) for to_ in range(3) </div><div class="line">        if from_ != to_ </div><div class="line">            and current_state[from_] &gt; 0 </div><div class="line">            and current_state[to_] &lt; bucket_volume[to_] </div><div class="line">    ]</div><div class="line">    #通过列表推导式获得下一动作的二元组构成的列表，由（倒出水的容器编号，倒入水的容器编号）组成。</div><div class="line">    #二重循环得到下一步的所有可能动作，然后通过</div><div class="line">    ##1.倒入倒出不能为同一个2.倒出的捅中必须有水3.倒入的桶中不能为满 的条件判断是否合法</div><div class="line">    for from_, to_ in next_action:</div><div class="line">        #next_state = current_state #浅复制造成错误</div><div class="line">        next_state = list(current_state)</div><div class="line">        if current_state[from_] + current_state[to_] &gt; bucket_volume[to_]:</div><div class="line">            next_state[from_] -= (bucket_volume[to_] - current_state[to_])</div><div class="line">            next_state[to_] = bucket_volume[to_]</div><div class="line">        else:</div><div class="line">            next_state[from_] = 0</div><div class="line">            next_state[to_] = current_state[to_] + current_state[from_]</div><div class="line">        yield next_state</div><div class="line">        #再由所有可能的合法动作得出所有的下一个状态，通过yield产生供其它函数调用。</div><div class="line"></div><div class="line">num = 0</div><div class="line">record_list = []</div><div class="line">#记录调试的变量：num表示总共实现方法数，record_list记录所有实现路径</div><div class="line"></div><div class="line">def searchResult(record, bucket_volume=[3,5,8], final_bucket_state=[0,4,4]):</div><div class="line"></div><div class="line">    global num，record_list</div><div class="line">    current_state = record[-1]</div><div class="line">    #由record的末尾元素得到当前水桶状态</div><div class="line">    next_state = nextStateLawful(current_state, bucket_volume)</div><div class="line">    #得到关于当前状态的下一状态的可迭代生成器，供下一步循环使用</div><div class="line">    for state in next_state:</div><div class="line">    #遍历所有可能的下一状态</div><div class="line">        if state not in record:</div><div class="line">            #保证当前状态没在以前出现过。如果状态已经出现还进行搜索就会形成状态环路，陷入死循环。</div><div class="line">            record.append(state)</div><div class="line">            #添加新的状态到列表中</div><div class="line">            if state == final_bucket_state:</div><div class="line">                print(record)</div><div class="line">                #打印出可行方案</div><div class="line">                #record_list.append(record)这样使用错误，导致加入列表的是record的引用，应该使用下面的式子来进行深复制，得到一个新的队列再加入列表。</div><div class="line">                record_list.append(deque(record))</div><div class="line">                num += 1</div><div class="line">            else:</div><div class="line">                searchResult(record, bucket_volume, final_bucket_state)</div><div class="line">                #不是最终状态则递归搜索</div><div class="line">            record.pop()</div><div class="line">            #去除当前循环中添加的状态，进入下一个循环，关键步，第一次实现的时候遗漏了</div><div class="line"></div><div class="line">if __name__==&apos;__main__&apos;:            </div><div class="line">    searchResult(record)</div><div class="line">    #开始</div><div class="line">    print(num)</div><div class="line">    #打印所有方案的数量</div><div class="line">    print(min([len(i) for i in record_list]))</div><div class="line">    #打印最短路径方案中的状态总数</div><div class="line"></div><div class="line">作者：treelake</div><div class="line">链接：https://www.jianshu.com/p/46f6aa196e1e</div><div class="line">來源：简书</div><div class="line">著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</div></pre></td></tr></table></figure>
<p>有javascript版本的</p>
<p><a href="https://segmentfault.com/a/1190000004907496" target="_blank" rel="external">js解法</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">var FullBacket = [8,5,3]            //桶的最大容量</div><div class="line">var states = [[8,0,0]];             //状态队列，js的数组已经已经有队列和堆栈的支持</div><div class="line"></div><div class="line">function CanTakeDumpAction(curr,from,to)&#123;</div><div class="line">    if(from &gt;= 0 &amp;&amp; from &lt; 3 &amp;&amp; to &gt;= 0 &amp;&amp; to &lt; 3)&#123;</div><div class="line">        if(from != to &amp;&amp; curr[from] &gt; 0 &amp;&amp; curr[to] &lt; FullBacket[to])&#123;</div><div class="line">            return true;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return false;</div><div class="line">&#125;</div><div class="line"></div><div class="line">function DumpWater(curr,from,to)&#123;</div><div class="line">    var next = curr.slice();        //js对象为引用传值，这里要复制一份</div><div class="line">    var dump_water = FullBacket[to] - curr[to] &gt; curr[from] ? curr[from] : FullBacket[to] - curr[to]            //倒水量的计算</div><div class="line">    next[from] -= dump_water;</div><div class="line">    next[to] += dump_water;</div><div class="line">    return next;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">function IsStateExist(state)&#123;</div><div class="line">    for(var i = 0; i &lt; states.length; i++)&#123;</div><div class="line">        if(state[0] == states[i][0] &amp;&amp; state[1] == states[i][1] &amp;&amp; state[2] == states[i][2])&#123;</div><div class="line">            return true;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return false;</div><div class="line">&#125;</div><div class="line"></div><div class="line">(function SearchState(states)&#123;</div><div class="line">    var curr = states[states.length - 1];</div><div class="line">    if(curr[0] == 4 &amp;&amp; curr[1] == 4)&#123;            //找到正确解</div><div class="line">        var rs = &apos;&apos;</div><div class="line">        states.forEach(function(al)&#123;</div><div class="line">            rs += al.join(&apos;,&apos;) + &apos; -&gt; &apos;;</div><div class="line">        &#125;);</div><div class="line">        console.log(rs.substr(0,rs.length - 4))</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    for(var j = 0; j &lt; 3; j++)&#123;                //所有的倒水方案即为桶编号的全排列</div><div class="line">        for(var i = 0; i &lt; 3; i++)&#123;</div><div class="line">            if(CanTakeDumpAction(curr,i,j))&#123;</div><div class="line">                var next = DumpWater(curr,i,j);</div><div class="line">                if(!IsStateExist(next))&#123;        //找到新状态</div><div class="line">                    states.push(next);</div><div class="line">                    SearchState(states);</div><div class="line">                    states.pop();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;)(states);</div></pre></td></tr></table></figure>
<p>这里是我写的elixir的解法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line">defmodule WaterSplit do</div><div class="line">  @moduledoc &quot;&quot;&quot;</div><div class="line">  三桶水均分8升水，求出所有的解法，三桶的容积分别为3,5,8</div><div class="line">  解题思路：</div><div class="line">  1. 由当前状态得到所有可能的合法动作</div><div class="line">  2. 由合法动作得到下一个状态</div><div class="line">  3. 建立一个状态队列来实现状态记录以及检查新状态是否在队列中已经出现，避免形成死循环</div><div class="line">  4. 递归搜索，在达到final状态时终止</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  require Logger</div><div class="line">  @doc &quot;&quot;&quot;</div><div class="line">  倒一次水, 所有的结果</div><div class="line">  笨办法，一个个枚举</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  def pull_once(0, 0, 8), do: [[0, 5, 3], [3, 0, 5]]</div><div class="line">  def pull_once(0, 5, 3), do: [[3, 2, 3], [3, 5, 0]]</div><div class="line">  def pull_once(3, 0, 5), do: [[0, 3, 5], [3, 5, 0]]</div><div class="line">  def pull_once(3, 5, 0), do: [[0, 5, 3], [3, 0, 5]]</div><div class="line">  def pull_once(0, 3, 5), do: [[3, 0, 5], [3, 3, 2], [0, 5, 3]]</div><div class="line">  def pull_once(0, 2, 6), do: [[2, 0, 6], [3, 2, 3], [0, 5, 3]]</div><div class="line">  def pull_once(3, 3, 2), do: [[1, 5, 2], [0, 3, 5], [3, 0, 5], [3, 5, 0]]</div><div class="line">  def pull_once(2, 0, 6), do: [[0, 2, 6], [3, 0, 5], [2, 5, 1]]</div><div class="line">  def pull_once(3, 2, 3), do: [[0, 5, 3], [0, 2, 6], [3, 0, 5], [3, 5, 0]]</div><div class="line">  def pull_once(1, 5, 2), do: [[0, 5, 3], [3, 3, 2], [1, 0, 7], [3, 5, 0]]</div><div class="line">  def pull_once(2, 5, 1), do: [[0, 5, 3], [3, 4, 1], [3, 5, 0]]</div><div class="line">  def pull_once(1, 0, 7), do: [[0, 1, 7], [3, 0, 5], [1, 5, 2]]</div><div class="line">  def pull_once(3, 4, 1), do: [[2, 5, 1], [0, 4, 4], [3, 0, 5], [3, 5, 0]]</div><div class="line">  def pull_once(0, 1, 7), do: [[1, 0, 7], [3, 1, 4], [0, 5, 3]]</div><div class="line">  def pull_once(3, 1, 4), do: [[0, 4, 4], [0, 1, 7], [3, 0, 5], [3, 5, 0]]</div><div class="line"></div><div class="line"></div><div class="line">  @doc &quot;&quot;&quot;</div><div class="line">  检查是否在链条里面，避免形成死循环</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  def in_queue?(queue, state), do: iq(queue, state)</div><div class="line">  defp iq([h|_t], state) when h == state, do: true</div><div class="line">  defp iq([_|t], state), do: iq(t, state)</div><div class="line">  defp iq([], _state), do: false</div><div class="line"></div><div class="line"></div><div class="line">  @doc &quot;&quot;&quot;</div><div class="line">  状态转换, 状态链扩展</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  def sl_chain([[0, 4 ,4] | _t]=queue), do: [queue]</div><div class="line">  def sl_chain([[a, b, c] | _t]=queue) do</div><div class="line">    next_states = pull_once(a, b, c) |&gt; Enum.filter(fn x -&gt; not in_queue?(queue, x) end)</div><div class="line">    cond do</div><div class="line">      length(next_states) == 0 -&gt; [] # 该链断裂</div><div class="line">      :else -&gt; next_states |&gt; Enum.map(fn x -&gt; [x | queue] end)</div><div class="line">    end</div><div class="line">  end</div><div class="line"></div><div class="line">  @doc &quot;&quot;&quot;</div><div class="line">  树状结构转成列表</div><div class="line">  &quot;&quot;&quot;</div><div class="line">  def sl_chains(queues), do: queues |&gt; Enum.reduce([], fn x, acc -&gt; sl_chain(x) ++ acc end)</div><div class="line"></div><div class="line">  defp equal?(a, b), do: a == b</div><div class="line"></div><div class="line">  defp all_finish?(queues) do</div><div class="line">    queues |&gt; Enum.filter(fn [x|_] -&gt; x == [0, 4, 4] end)</div><div class="line">    |&gt; length() |&gt; equal?(length(queues))</div><div class="line">  end</div><div class="line">  </div><div class="line">  def solution() do</div><div class="line">    queues = sl_chain([[0, 0, 8]])</div><div class="line">    sl(queues)</div><div class="line">  end</div><div class="line"></div><div class="line">  defp sl(queues) do</div><div class="line">    cond do</div><div class="line">      queues |&gt; all_finish?() -&gt; queues</div><div class="line">      :else -&gt; sl_chains(queues) |&gt; sl()</div><div class="line">    end</div><div class="line">  end</div><div class="line">  </div><div class="line">end</div></pre></td></tr></table></figure>
<p>可能是心理作用，总觉得elixir版本的代码更加清晰明朗，也可能是py和js两个版本解法的代码编写风格的原因，我总认为一个好的语言能督促作者整理思路，这也许是就是个例证，也有可能就是我瞎YY的。</p>
<hr>
<p><img src="/images/wechat.jpeg" alt="Wechat"></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/31/数字与汉字互相转换的算法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tt67wq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/31/数字与汉字互相转换的算法/" itemprop="url">
                  数字与汉字相互转换的算法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              

              
                
              

              <time title="Post created: 2018-01-31 11:41:25" itemprop="dateCreated datePublished" datetime="2018-01-31T11:41:25+08:00">2018-01-31</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Updated at: 2018-04-23 14:08:18" itemprop="dateModified" datetime="2018-04-23T14:08:18+08:00">2018-04-23</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近完成了《数据结构和算法》的阅读，作为补充和总结，开始了《算法的乐趣》阅读，这里记录下里面一些算法的实现，有些在网上找不到合适的实现，就自己憋了一点出来。</p>
<p>第4章里面有个数字转中文的例子，用cpp写了部分的核心代码，我想用c仿写一遍，网上找了一圈也没有现成的可以抄，只有自己慢慢磨出来。</p>
<p>这个过程并不是特别顺利，知道算法怎么实现，和具体把它写出来运行成功还是有一定差距的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">纸上得来终觉浅，绝知此事要躬行</div><div class="line">                   ——出自《冬夜读书示子聿》</div></pre></td></tr></table></figure>
<p>以下是clang的代码，在osx下编译通过没有问题</p>
<p>简述下算法的思想，大概就是按照汉语的习惯是把数字每一万做一次分割，所以算法也是这么设计，每个section单独翻译，然后加上中间汉字拼接起来。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div></pre></td><td class="code"><pre><div class="line">/*</div><div class="line"> * =====================================================================================</div><div class="line"> *</div><div class="line"> *       Filename:  nums2chinese.c</div><div class="line"> *</div><div class="line"> *    Description:  数字转换成中文字符</div><div class="line"> *</div><div class="line"> *        Version:  1.0</div><div class="line"> *        Created:  2018-01-29</div><div class="line"> *       Revision:  none</div><div class="line"> *       Compiler:  gcc</div><div class="line"> *</div><div class="line"> *         Author:  wq</div><div class="line"> *</div><div class="line"> * =====================================================================================</div><div class="line"> */</div><div class="line">/* 算法的乐趣里面的例子，我把代码补充完整 */</div><div class="line"></div><div class="line">#include &lt;stdio.h&gt;</div><div class="line">#include &lt;stdlib.h&gt;</div><div class="line">#include &lt;string.h&gt;</div><div class="line"></div><div class="line">#define LENGTH(a) ((sizeof(a)) / (sizeof(a[0])))</div><div class="line">#define TRUE 1</div><div class="line">#define FALSE 0</div><div class="line"></div><div class="line">char *const chnNumChar[] = &#123;&quot;零&quot;, &quot;一&quot;, &quot;二&quot;, &quot;三&quot;, &quot;四&quot;,</div><div class="line">                            &quot;五&quot;, &quot;六&quot;, &quot;七&quot;, &quot;八&quot;, &quot;九&quot;&#125;;</div><div class="line">char *const chnUnitSection[] = &#123;&quot;&quot;, &quot;万&quot;, &quot;亿&quot;, &quot;万亿&quot;&#125;;</div><div class="line">char *const chnUnitChar[] = &#123;&quot;&quot;, &quot;十&quot;, &quot;百&quot;, &quot;千&quot;&#125;;</div><div class="line"></div><div class="line">char *Number2Chinese(int num);</div><div class="line">char *Section2Chinese(int);</div><div class="line">char *join(char *s1, char *s2);</div><div class="line"></div><div class="line">int main(int ac, char *av[]) &#123;</div><div class="line">	int num;</div><div class="line"></div><div class="line">	/* check args */</div><div class="line">	if (ac != 2) &#123;</div><div class="line">		fprintf(stderr, &quot;usage: num2chinese num\n&quot;);</div><div class="line">		exit(1);</div><div class="line">	&#125;</div><div class="line">	num = atoi(av[1]);</div><div class="line">	printf(&quot;输入数字: %d\n&quot;, num);</div><div class="line">	printf(&quot;转换结果: %s\n&quot;, Number2Chinese(num));</div><div class="line">	return 1;</div><div class="line">&#125;</div><div class="line"></div><div class="line">char *Number2Chinese(int num) &#123;</div><div class="line">	char *chnStr = &quot;&quot;;</div><div class="line">	int unitPos = 0;</div><div class="line">	char *strIns = &quot;&quot;;</div><div class="line">	int needZero = FALSE;</div><div class="line">	int section;</div><div class="line"></div><div class="line">	while (num &gt; 0) &#123;</div><div class="line">		section = num % 10000;</div><div class="line">		printf(&quot;section: %d\n&quot;, section);</div><div class="line">		if (needZero) &#123;</div><div class="line">			chnStr = join(chnNumChar[0], chnStr);</div><div class="line">		&#125;</div><div class="line">		strIns = Section2Chinese(section);</div><div class="line">		printf(&quot;section to chinese: %s\n&quot;, strIns);</div><div class="line">		strIns = join(strIns,</div><div class="line">			      (section != 0) ? chnUnitSection[unitPos] : chnUnitSection[0]);</div><div class="line">		chnStr = join(strIns, chnStr);</div><div class="line">		needZero = (section &lt; 1000) &amp;&amp; (section &gt; 0);</div><div class="line">		num = num / 10000;</div><div class="line">		++unitPos;</div><div class="line">	&#125;</div><div class="line">	return chnStr;</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 块 转成汉字</div><div class="line">char *Section2Chinese(int section) &#123;</div><div class="line">	char *chnStr = &quot;&quot;;</div><div class="line">	char *strIns = &quot;&quot;;</div><div class="line">	int unitPos = 0;</div><div class="line">	int zero = TRUE;</div><div class="line">	int v;</div><div class="line"></div><div class="line">	while (section &gt; 0) &#123;</div><div class="line">		v = section % 10;</div><div class="line">		if (v == 0) &#123;</div><div class="line">			if ((section == 0) || !zero) &#123;</div><div class="line">				zero = TRUE;</div><div class="line">				chnStr = join(chnNumChar[v], chnStr);</div><div class="line">			&#125;</div><div class="line">		&#125; else &#123;</div><div class="line">			zero = FALSE;</div><div class="line">			strIns = chnNumChar[v];</div><div class="line">			strIns = join(strIns, chnUnitChar[unitPos]);</div><div class="line">			chnStr = join(strIns, chnStr);</div><div class="line">		&#125;</div><div class="line">		unitPos++;</div><div class="line">		section = section / 10;</div><div class="line">	&#125;</div><div class="line">	return chnStr;</div><div class="line">&#125;</div><div class="line"></div><div class="line">char *join(char *s1, char *s2) &#123;</div><div class="line">	char *result = malloc(strlen(s1) + strlen(s2) + 1);</div><div class="line">	// in real code you would check for errors in malloc here</div><div class="line">	if (result == NULL)</div><div class="line">		exit(1);</div><div class="line"></div><div class="line">	strcpy(result, s1);</div><div class="line">	strcat(result, s2);</div><div class="line"></div><div class="line">	return result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">~/classical(master*) » gcc nums2chinese.c -o n2c</div><div class="line">~/classical(master*) » ./n2c 41523                                                                                                                                                                                               qiangwan@qiangdeMacBook-Pro</div><div class="line">输入数字: 41523</div><div class="line">section: 1523</div><div class="line">section to chinese: 一千五百二十三</div><div class="line">section: 4</div><div class="line">section to chinese: 四</div><div class="line">转换结果: 四万一千五百二十三</div></pre></td></tr></table></figure>
<p>接下来是逆过程的算法，就是把汉字转成数字，思路跟上面差不多，就是实现上是倒过来的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div></pre></td><td class="code"><pre><div class="line">/*</div><div class="line"> * =====================================================================================</div><div class="line"> *</div><div class="line"> *       Filename:  chinses2num.c</div><div class="line"> *</div><div class="line"> *    Description:  中文转阿拉伯数字</div><div class="line"> *</div><div class="line"> *        Version:  1.0</div><div class="line"> *        Created:  2018-02-01</div><div class="line"> *       Revision:  none</div><div class="line"> *       Compiler:  gcc</div><div class="line"> *</div><div class="line"> *         Author:  wanqiang</div><div class="line"> *</div><div class="line"> * =====================================================================================</div><div class="line"> */</div><div class="line">/* https://segmentfault.com/a/1190000004881457 */</div><div class="line"></div><div class="line">#include &lt;stdio.h&gt;</div><div class="line">#include &lt;stdlib.h&gt;</div><div class="line">#include &lt;string.h&gt;</div><div class="line"></div><div class="line">#define LENGTH(a) ((sizeof(a)) / (sizeof(a[0])))</div><div class="line">#define TRUE 1</div><div class="line">#define FALSE 0</div><div class="line"></div><div class="line">typedef struct _chn &#123;</div><div class="line">        char *ch;</div><div class="line">        int num;</div><div class="line">&#125; ChineseNum;</div><div class="line"></div><div class="line">typedef struct _chs &#123;</div><div class="line">        char *ch;</div><div class="line">        int value;</div><div class="line">        int secUnit;</div><div class="line">&#125; ChineseName;</div><div class="line"></div><div class="line">ChineseNum const chnNumMap[10] = &#123;&#123;&quot;零&quot;, 0&#125;, &#123;&quot;一&quot;, 1&#125;, &#123;&quot;二&quot;, 2&#125;, &#123;&quot;三&quot;, 3&#125;,</div><div class="line">                                  &#123;&quot;四&quot;, 4&#125;, &#123;&quot;五&quot;, 5&#125;, &#123;&quot;六&quot;, 6&#125;, &#123;&quot;七&quot;, 7&#125;,</div><div class="line">                                  &#123;&quot;八&quot;, 8&#125;, &#123;&quot;九&quot;, 9&#125;&#125;;</div><div class="line"></div><div class="line">ChineseName const chnNameMap[5] = &#123;&#123;&quot;十&quot;, 10, FALSE&#125;,</div><div class="line">                                   &#123;&quot;百&quot;, 100, FALSE&#125;,</div><div class="line">                                   &#123;&quot;千&quot;, 1000, FALSE&#125;,</div><div class="line">                                   &#123;&quot;万&quot;, 10000, TRUE&#125;,</div><div class="line">                                   &#123;&quot;亿&quot;, 100000000, TRUE&#125;&#125;;</div><div class="line"></div><div class="line">int chinese2num(char **chnStr, int);</div><div class="line">int numHash(char *);</div><div class="line">ChineseName nameHash(char *);</div><div class="line">int main() &#123;</div><div class="line">        char *chn[9] = &#123;&quot;九&quot;, &quot;万&quot;, &quot;六&quot;, &quot;千&quot;, &quot;四&quot;, &quot;百&quot;, &quot;八&quot;, &quot;十&quot;, &quot;七&quot;&#125;;</div><div class="line">        printf(&quot;%lu\n&quot;, LENGTH(chn));</div><div class="line">        printf(&quot;九百八十七   转换后结果为: %d\n&quot;,</div><div class="line">               chinese2num(chn, LENGTH(chn)));</div><div class="line">        return 0;</div><div class="line">&#125;</div><div class="line"></div><div class="line">int chinese2num(char **chnStr, int size) &#123;</div><div class="line">        int rtn = 0;</div><div class="line">        int section = 0;</div><div class="line">        int number = 0;</div><div class="line">        int secUnit = FALSE;</div><div class="line">        int i, num, unit;</div><div class="line"></div><div class="line">        for (i = 0; i &lt; size; i++) &#123;</div><div class="line">                num = numHash(chnStr[i]);</div><div class="line">                printf(&quot;num:%d\n&quot;, num);</div><div class="line">                if (num &gt;= 0) &#123;</div><div class="line">                        number = num;</div><div class="line">                        if (i == size - 1) &#123;</div><div class="line">                                section += number;</div><div class="line">                        &#125;</div><div class="line">                &#125; else &#123;</div><div class="line">                        unit = nameHash(chnStr[i]).value;</div><div class="line">                        secUnit = nameHash(chnStr[i]).secUnit;</div><div class="line">                        printf(&quot;unit: %d, secUnit: %d\n&quot;, unit, secUnit);</div><div class="line">                        if (secUnit) &#123;</div><div class="line">                                section = (section + number) * unit;</div><div class="line">                                rtn += section;</div><div class="line">                                section = 0;</div><div class="line">                        &#125; else &#123;</div><div class="line">                                section += (number * unit);</div><div class="line">                        &#125;</div><div class="line">                        number = 0;</div><div class="line">                &#125;</div><div class="line">        &#125;</div><div class="line">        return rtn + section;</div><div class="line">&#125;</div><div class="line"></div><div class="line">int numHash(char *ch) &#123;</div><div class="line">        for (int i = 0; i &lt; 10; i++) &#123;</div><div class="line">                if (chnNumMap[i].ch == ch) &#123;</div><div class="line">                        return chnNumMap[i].num;</div><div class="line">                &#125;</div><div class="line">        &#125;</div><div class="line">        return -1;</div><div class="line">&#125;</div><div class="line"></div><div class="line">ChineseName nameHash(char *name) &#123;</div><div class="line">        ChineseName cn;</div><div class="line">        for (int i = 0; i &lt; 5; ++i) &#123;</div><div class="line">                if (chnNameMap[i].ch == name) &#123;</div><div class="line">                        return chnNameMap[i];</div><div class="line">                &#125;</div><div class="line">        &#125;</div><div class="line">        cn.ch = &quot;&quot;;</div><div class="line">        cn.value = 0;</div><div class="line">        cn.secUnit = 0;</div><div class="line">        return cn;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>执行结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">9</div><div class="line">num:9</div><div class="line">num:-1</div><div class="line">unit: 10000, secUnit: 1</div><div class="line">num:6</div><div class="line">num:-1</div><div class="line">unit: 1000, secUnit: 0</div><div class="line">num:4</div><div class="line">num:-1</div><div class="line">unit: 100, secUnit: 0</div><div class="line">num:8</div><div class="line">num:-1</div><div class="line">unit: 10, secUnit: 0</div><div class="line">num:7</div><div class="line">九万六千四百八十七   转换后结果为: 96487</div></pre></td></tr></table></figure>
<hr>
<p><img src="/images/wechat.jpeg" alt="Wechat"></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/29/自驱动的见解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tt67wq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/29/自驱动的见解/" itemprop="url">
                  自驱动的见解
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              

              
                
              

              <time title="Post created: 2018-01-29 12:00:43" itemprop="dateCreated datePublished" datetime="2018-01-29T12:00:43+08:00">2018-01-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Updated at: 2018-04-23 14:07:58" itemprop="dateModified" datetime="2018-04-23T14:07:58+08:00">2018-04-23</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近看了不少大佬的事迹，也看了不少大佬的代码，一直在想一个问题：</p>
<p><strong>是什么因素导致了有些人成为了大佬，而有些人成了我这样的废柴</strong></p>
<p>小时候看名人传记，传记中无非强调的都是大佬们如何刻苦学习，如何天赋异禀，就像平时看的修真小说的主角，可是我们忽略了一些因素，为什么有些大佬在肚子都吃不饱的时候还能对有些领域有近乎痴迷的热情。</p>
<p>从读小学开始，我就被告知，要好好学习，考个好成绩，为了自己的荣誉，也为了家长的脸面。从始至终，我也渐渐习惯了让别人的目光成为自己的动力。可是到了高中毕业，进入大学，进入社会之后，我迷失了。我失去了学习的动力，内心中找寻不到驱动的力量。</p>
<p>我现在渐渐明白过来，之前的驱动力只是外驱，我从来没有过内驱，外在的驱动其实就是一张虚荣心，虚荣心会使人进步一时，但是不能长久。</p>
<p>我在看《死亡诗社》的时候，里面有一句台词</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">我们读诗、写诗并不是因为他们好玩，而是因为我们是人类的一分子，而人类是充满激情的。</div><div class="line">没错，医学、法律、商业、工程，这些都是崇高的追求，足以支撑人的一生。但诗歌、美丽、浪漫、爱情，这些才是我们活着的意义。</div></pre></td></tr></table></figure>
<p> 至于如何找到和维护自己的内在动力，我还没想好.</p>
<p> Fuck it!</p>
<hr>
<p><img src="/images/wechat.jpeg" alt="Wechat"></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/13/源码阅读计划/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tt67wq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/13/源码阅读计划/" itemprop="url">
                  源码阅读计划
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posté le</span>
              

              
                
              

              <time title="Post created: 2018-01-13 13:59:13" itemprop="dateCreated datePublished" datetime="2018-01-13T13:59:13+08:00">2018-01-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Updated at: 2018-04-23 14:07:46" itemprop="dateModified" datetime="2018-04-23T14:07:46+08:00">2018-04-23</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>为了从一个二流撸业务的程序员进化成一个能独当一面的老狗币，我给自己制定了诸多的方案，像源码阅读就是其中之一，但是受限于之前水平太次，读源码也读不出啥东西来，基本处于读了几行就心浮气躁，然后放弃的循环。</p>
<p>后来发现了症结所在，一是自己经验有不足，就像字没认够就去读书一样，二是起始的目标定的过高，导致行动力不足，望着山高不知如何开始攀登的窘境。</p>
<p>现在开始重新整理一波想要阅读的东西</p>
<ol>
<li>redis源码。这个也是老司机推荐给我的，一个是代码比较亲和，容易看懂，二来读redis对linux的内存管理会理解更深；</li>
<li>Tinyhttpd 一个c写的http原型，一共才百来行，对理解http server的模型大有帮助(已经读完了，现在已经忘了)；</li>
<li>beanstalkd 通过几千行 C 代码实现了一个优先级/延时队列，一个相当酷的项目；</li>
<li>libdict 一个c语言的各种树的实现，红黑树，AVL树，伸展树，一边练习读代码的能力，一边复习下算法； </li>
</ol>
<p>阅读的时候我会先fork一个库，在阅读期间的注释我会补充到代码里面。</p>
<p>暂时先准备读这些，不知道这次的阅读计划能不能完成，就像每年年初制定的计划，到了年底也未必能完成多少，走一步看一步吧。</p>
<hr>
<p><img src="/images/wechat.jpeg" alt="Wechat"></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">tt67wq</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">16</span>
                    <span class="site-state-item-name">articles</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">tt67wq</span>

  

  
</div>




  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> v3.3.9</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Thème &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Muse</a> v6.3.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



	





  





  










  





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
